<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Advanced Single-File HTML ‚Äî Interactive Portfolio</title>
  <meta name="description" content="A compact advanced single-file HTML demo showcasing accessibility, responsive layout, animations, JS modules, fetch, localStorage, dark mode, form validation and small canvas visual." />
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ctext y='0.9em' font-size='80'%3Eüé¨%3C/text%3E%3C/svg%3E">

  <style>
    :root{
      --bg:#0f1724; --card:#0b1220; --muted:#98a0b3; --accent: #7c5cff; --glass: rgba(255,255,255,0.04);
      --radius:12px; --shadow: 0 8px 30px rgba(2,6,23,0.6);
      color-scheme: dark;
    }
    [data-theme='light']{
      --bg:#f5f7fb; --card:#ffffff; --muted:#475569; --accent:#6d28d9; --glass: rgba(0,0,0,0.04); color-scheme: light;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family: Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue';background:linear-gradient(180deg,var(--bg),#071228);color: #e6eef8;}

    .app{max-width:1100px;margin:36px auto;padding:28px}
    header{display:flex;align-items:center;justify-content:space-between;gap:20px}
    .brand{display:flex;align-items:center;gap:14px}
    .logo{width:48px;height:48px;border-radius:10px;background:linear-gradient(135deg,var(--accent),#4cc9f0);display:grid;place-items:center;font-weight:700}
    h1{font-size:20px;margin:0}
    nav{display:flex;gap:10px;align-items:center}
    .btn{background:var(--glass);border:1px solid rgba(255,255,255,0.04);padding:8px 12px;border-radius:10px;cursor:pointer}
    .btn:focus{outline:3px solid rgba(124,92,255,0.18)}

    main{display:grid;grid-template-columns:1fr 360px;gap:24px;margin-top:22px}
    .panel{background:var(--card);padding:18px;border-radius:var(--radius);box-shadow:var(--shadow)}

    /* hero */
    .hero{display:flex;flex-direction:column;gap:12px}
    .meta{display:flex;gap:10px;align-items:center}
    .meta img{width:48px;height:48px;border-radius:8px;object-fit:cover}
    .chips{display:flex;gap:8px;flex-wrap:wrap}
    .chip{padding:6px 8px;border-radius:999px;background:linear-gradient(90deg,rgba(255,255,255,0.02),transparent);font-size:12px;border:1px solid rgba(255,255,255,0.03)}

    /* gallery */
    .gallery{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:14px}
    .card{border-radius:10px;overflow:hidden;min-height:120px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);display:flex;flex-direction:column}
    .card img{width:100%;height:140px;object-fit:cover}
    .card .info{padding:10px}

    /* sidebar */
    aside .small{font-size:13px;color:var(--muted)}
    .stats{display:flex;gap:10px;align-items:center;margin-top:10px}
    .stat{flex:1;padding:10px;background:linear-gradient(180deg,transparent,rgba(0,0,0,0.03));border-radius:8px;text-align:center}

    /* form */
    form{display:flex;flex-direction:column;gap:10px}
    label{font-size:13px;color:var(--muted)}
    input,textarea,select{padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit}
    input:focus,textarea:focus,select:focus{outline:3px solid rgba(124,92,255,0.12)}
    .row{display:flex;gap:10px}

    footer{margin-top:18px;text-align:center;color:var(--muted);font-size:13px}

    /* responsive */
    @media (max-width:980px){main{grid-template-columns:1fr} .gallery{grid-template-columns:repeat(2,1fr)} aside{order:2}}
    @media (max-width:520px){.gallery{grid-template-columns:1fr} header{flex-direction:column;align-items:flex-start} .brand h1{font-size:16px}}

    /* subtle animations */
    .fade-in{animation:fadeIn .6s ease both}
    @keyframes fadeIn{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:none}}

    /* accessible focus visible */
    :focus{outline: none}
    :focus-visible{outline:3px solid rgba(124,92,255,0.18);outline-offset:3px}

  </style>
</head>
<body>
  <div class="app" id="app">
    <header>
      <div class="brand">
        <div class="logo" aria-hidden>üé¨</div>
        <div>
          <h1 id="title">Cinematic Portfolio</h1>
          <div class="small" id="subtitle">Interactive demo ‚Äî single-file HTML</div>
        </div>
      </div>

      <nav aria-label="Main navigation">
        <button class="btn" id="themeToggle" title="Toggle light/dark">Toggle theme</button>
        <button class="btn" id="downloadBtn" title="Download snapshot">Export PNG</button>
      </nav>
    </header>

    <main>
      <section class="panel hero fade-in" aria-labelledby="title">
        <div class="meta">
          <img src="https://images.unsplash.com/photo-1515879218367-8466d910aaa4?q=80&w=400&auto=format&fit=crop&ixlib=rb-4.0.3&s=placeholder" alt="Profile photo" loading="lazy">
          <div>
            <strong>By: You</strong>
            <div class="small">Frontend ¬∑ Filmmaker ¬∑ Creator</div>
          </div>
        </div>

        <p class="small" style="margin-top:10px">A compact single-file demo combining modern HTML, CSS variables, JS features and progressive UX. Works offline if you enable a service worker (snippet included in comments).</p>

        <div class="chips" aria-hidden>
          <span class="chip">Responsive</span>
          <span class="chip">Accessible</span>
          <span class="chip">Fetch API</span>
          <span class="chip">LocalStorage</span>
          <span class="chip">Canvas</span>
        </div>

        <div class="gallery" id="gallery" role="list">
          <!-- cards inserted by JS -->
        </div>

        <details style="margin-top:12px;color:var(--muted)"><summary>Code snippets & notes</summary>
          <p class="small">This page lazy-loads images, validates contact forms, uses localStorage for theme preference, fetches a demo dataset, and shows a small canvas audio-visualizer stub. Remove external images if you want a fully offline single file.</p>
        </details>
      </section>

      <aside class="panel fade-in" aria-label="Sidebar">
        <div>
          <div class="small">Quick Stats</div>
          <div class="stats" role="list">
            <div class="stat"><strong id="visits">0</strong><div class="small">Visits</div></div>
            <div class="stat"><strong id="shots">9</strong><div class="small">Shots</div></div>
          </div>

          <hr style="margin:12px 0;border:none;border-top:1px solid rgba(255,255,255,0.03)">

          <div class="small">Contact</div>
          <form id="contact" novalidate>
            <label for="name">Name</label>
            <input id="name" name="name" required minlength="2" placeholder="Your name">

            <label for="email">Email</label>
            <input id="email" name="email" type="email" required placeholder="you@example.com">

            <div class="row">
              <div style="flex:1">
                <label for="type">Type</label>
                <select id="type" name="type">
                  <option>Project</option>
                  <option>Collab</option>
                  <option>Other</option>
                </select>
              </div>
              <div style="flex:1">
                <label for="budget">Budget</label>
                <input id="budget" name="budget" type="number" min="0" placeholder="‚Çπ">
              </div>
            </div>

            <label for="message">Message</label>
            <textarea id="message" name="message" rows="4" placeholder="Short message" required></textarea>

            <div style="display:flex;gap:8px;margin-top:6px">
              <button class="btn" type="submit">Send</button>
              <button class="btn" type="button" id="clearBtn">Clear</button>
            </div>
          </form>

          <hr style="margin:12px 0;border:none;border-top:1px solid rgba(255,255,255,0.03)">

          <div class="small">Canvas playground</div>
          <canvas id="visual" width="320" height="120" style="width:100%;border-radius:8px;margin-top:8px;background:linear-gradient(180deg,rgba(255,255,255,0.01),transparent)"></canvas>

        </div>

        <footer>
          <div>Built with ‚ù§Ô∏è ‚Äî demo</div>
          <div style="margin-top:6px"><small class="small">Press <kbd>Ctrl</kbd>+<kbd>S</kbd> to save a snapshot locally</small></div>
        </footer>
      </aside>
    </main>
  </div>

  <script>
    // Immediately-applicable helpers
    const $ = sel => document.querySelector(sel);
    const $all = sel => Array.from(document.querySelectorAll(sel));

    // Theme toggling with localStorage
    const root = document.documentElement;
    const themeToggle = $('#themeToggle');
    const saved = localStorage.getItem('theme') || (window.matchMedia && window.matchMedia('(prefers-color-scheme:light)').matches ? 'light' : 'dark');
    document.documentElement.setAttribute('data-theme', saved);
    themeToggle.addEventListener('click', () => {
      const cur = document.documentElement.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
      document.documentElement.setAttribute('data-theme', cur);
      localStorage.setItem('theme', cur);
    });

    // Simple stats
    const visitsEl = $('#visits');
    const visits = Number(localStorage.getItem('visits') || 0) + 1;
    localStorage.setItem('visits', visits);
    visitsEl.textContent = visits;

    // Demo gallery data (static fallback + fetch demonstration)
    const fallback = [
      {id:1,title:'Library',src:'https://images.unsplash.com/photo-1496307042754-b4aa456c4a2d?q=80&w=800&auto=format&fit=crop'},
      {id:2,title:'City',src:'https://images.unsplash.com/photo-1508921912186-1d1a45ebb3c1?q=80&w=800&auto=format&fit=crop'},
      {id:3,title:'Mountains',src:'https://images.unsplash.com/photo-1501785888041-af3ef285b470?q=80&w=800&auto=format&fit=crop'},
      {id:4,title:'Desk',src:'https://images.unsplash.com/photo-1515378791036-0648a3ef77b2?q=80&w=800&auto=format&fit=crop'},
      {id:5,title:'Studio',src:'https://images.unsplash.com/photo-1470847353802-5f4a0d6b5b28?q=80&w=800&auto=format&fit=crop'},
      {id:6,title:'Road',src:'https://images.unsplash.com/photo-1432821596592-e2c18b78144f?q=80&w=800&auto=format&fit=crop'},
      {id:7,title:'Coffee',src:'https://images.unsplash.com/photo-1509042239860-f550ce710b93?q=80&w=800&auto=format&fit=crop'},
      {id:8,title:'Film',src:'https://images.unsplash.com/photo-1517604931442-65b2f3ff3a28?q=80&w=800&auto=format&fit=crop'},
      {id:9,title:'Neon',src:'https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?q=80&w=800&auto=format&fit=crop'}
    ];

    const gallery = $('#gallery');
    function render(items){
      gallery.innerHTML = '';
      items.forEach(it => {
        const el = document.createElement('article');
        el.setAttribute('role','listitem');
        el.className = 'card';
        el.innerHTML = `\n          <img loading='lazy' decoding='async' src='${it.src}' alt='${it.title}'>\n          <div class='info'>\n            <strong>${it.title}</strong>\n            <div class='small'>Shot ${it.id}</div>\n          </div>`;
        gallery.appendChild(el);
      });
    }

    // Try fetching an example JSON to demonstrate network fetch, but fall back silently
    fetch('https://jsonplaceholder.typicode.com/photos?_limit=6')
      .then(r=>r.json())
      .then(data => {
        if(Array.isArray(data) && data.length) {
          const mapped = data.map((d,i)=>({id:d.id,title:d.title,src:d.thumbnailUrl.replace('http:','https:')})).slice(0,9);
          render(mapped.concat(fallback.slice(mapped.length)));
        } else render(fallback);
      }).catch(err=>{
        console.warn('Fetch failed ‚Äî using fallback.',err);
        render(fallback);
      });

    // Contact form handling (local demo)
    const form = $('#contact');
    const clearBtn = $('#clearBtn');
    form.addEventListener('submit', e => {
      e.preventDefault();
      if(!form.checkValidity()){
        form.reportValidity();
        return;
      }
      const data = Object.fromEntries(new FormData(form));
      // simulate submit and show toast
      showToast('Message queued (demo). Check console.');
      console.log('Form data:', data);
      form.reset();
    });
    clearBtn.addEventListener('click', ()=>form.reset());

    // Small toast helper
    function showToast(msg){
      const t = document.createElement('div');
      t.textContent = msg; t.style.position='fixed'; t.style.left='50%'; t.style.transform='translateX(-50%)';
      t.style.bottom='28px'; t.style.padding='10px 14px'; t.style.background='rgba(0,0,0,0.6)'; t.style.borderRadius='8px'; t.style.zIndex=9999;
      document.body.appendChild(t);
      setTimeout(()=>{t.style.transition='opacity .3s'; t.style.opacity='0'; setTimeout(()=>t.remove(),300)},2400);
    }

    // Canvas visual simple animation
    const canvas = document.getElementById('visual');
    const ctx = canvas.getContext('2d');
    let t=0;
    function draw(){
      const w = canvas.width = canvas.clientWidth * devicePixelRatio;
      const h = canvas.height = canvas.clientHeight * devicePixelRatio;
      ctx.clearRect(0,0,w,h);
      for(let i=0;i<6;i++){
        ctx.beginPath();
        const x = (w/6)*(i+0.5) + Math.sin(t/20 + i)*20;
        const y = h/2 + Math.cos(t/15 + i)*18;
        ctx.arc(x,y,Math.abs(Math.sin(t/40+i))*18+4,0,Math.PI*2);
        ctx.fillStyle = `rgba(124,92,255,${0.22 - i*0.02})`;
        ctx.fill();
      }
      t+=1;
      requestAnimationFrame(draw);
    }
    draw();

    // Export snapshot - render the app container to an image using HTMLCanvas approach (simple)
    const downloadBtn = $('#downloadBtn');
    downloadBtn.addEventListener('click', async ()=>{
      try{
        showToast('Preparing snapshot ‚Äî right-click to save when it appears.');
        // create simple canvas and draw basic content (not full DOM rasterization since no external libs)
        const box = document.getElementById('app');
        const w = Math.min(box.clientWidth, 1200);
        const h = box.clientHeight;
        const c = document.createElement('canvas'); c.width = w*devicePixelRatio; c.height = h*devicePixelRatio;
        const cctx = c.getContext('2d'); cctx.scale(devicePixelRatio, devicePixelRatio);
        cctx.fillStyle = getComputedStyle(document.body).background || '#071228'; cctx.fillRect(0,0,w,h);
        cctx.fillStyle = '#fff'; cctx.font = '18px sans-serif'; cctx.fillText('Snapshot ‚Äî open the page to see full content',20,60);
        // attach to body in overlay
        const img = new Image(); img.src = c.toDataURL('image/png');
        const overlay = document.createElement('div'); overlay.style.position='fixed'; overlay.style.left=0; overlay.style.top=0; overlay.style.right=0; overlay.style.bottom=0; overlay.style.background='rgba(0,0,0,0.6)'; overlay.style.display='grid'; overlay.style.placeItems='center'; overlay.style.zIndex=9999;
        img.style.maxWidth='90%'; img.style.maxHeight='90%'; img.style.borderRadius='8px'; img.style.boxShadow='0 20px 60px rgba(0,0,0,0.6)'; overlay.appendChild(img);
        overlay.addEventListener('click', ()=>overlay.remove());
        document.body.appendChild(overlay);
      }catch(e){console.error(e); showToast('Snapshot failed.');}
    });

    // Accessibility: keyboard shortcut to focus gallery
    window.addEventListener('keydown', e => {
      if((e.ctrlKey || e.metaKey) && e.key.toLowerCase()==='k'){
        e.preventDefault(); gallery.querySelector('article')?.focus();
      }
      // ctrl+s save (fake) ‚Äî open snapshot overlay
      if((e.ctrlKey || e.metaKey) && e.key.toLowerCase()==='s'){
        e.preventDefault(); $('#downloadBtn').click();
      }
    });

    // Small progressive enhancement: register a service worker (commented ‚Äî enable if you add sw file)
    /*
    if('serviceWorker' in navigator){
      navigator.serviceWorker.register('/sw.js').then(()=>console.log('sw registered'))
    }
    */

    // Focus management for generated cards
    new MutationObserver(()=>{
      const articles = gallery.querySelectorAll('article');
      articles.forEach(a=>a.setAttribute('tabindex',0));
    }).observe(gallery,{childList:true});

    // Small utility: monitor network and show status
    function updateNetwork(){
      if(navigator.onLine) document.title = 'Cinematic Portfolio';
      else document.title = '(offline) Cinematic Portfolio';
    }
    window.addEventListener('online', updateNetwork); window.addEventListener('offline', updateNetwork); updateNetwork();

    // end of script
  </script>
</body>
</html>